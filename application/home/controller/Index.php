<?phpnamespace app\home\controller;use think\Controller;use think\Db;class Index extends Base {    public function index(){        $banner =  db('banner')->where('enabled',1)->cache(true,1800)->order('pid asc')->select();		$where['is_open']=1;		$where['isrecommend']=1;		//推荐首页		$recommand =  db('recruit')->where($where)->cache(true,1800)->order('displayorder desc')->select();		//数组		$type = array('default','primary','success', 'info', 'warning','link');		//浏览最多		$scan =  db('recruit')->where('is_open',1)->cache(true,1800)->order('count desc')->limit(10)->select();		$new =  db('recruit')->where('is_open',1)->cache(true,1800)->order('id desc')->limit(10)->select();		foreach($recommand as &$v){			$label=json_decode($v['label'],true);			if($label){			   $str=implode(",",$label);			 $v['labelname'] =  M('label')->where('id','in',$str)->order('id desc')->select();				foreach($v['labelname'] as $k=>$d){					$v['labelname'][$k]['css']=$type[rand(0,8)];				}			}			if($v['publish_time']){				$v['createtime']=date('Y-m-d',$v['publish_time']);			}else{				$v['createtime']=date('Y-m-d',$v['add_time']);			}			$v['css']=$type[rand(0,7)];		}		unset($v);		$label=  db('label')->order('id desc')->select();		foreach($label as &$d){			$d['style']='font-size:'.rand(12,24).'px;color:#'.rand(0,999999);;		}		$this->assign('banner',$banner);// 轮播		$this->assign('recommand',$recommand);// 推荐		$this->assign('scan',$scan);// 浏览最多		$this->assign('new',$new);// 最新发布		$this->assign('label',$label);// 标签        return $this->fetch();    }}