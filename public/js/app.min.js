/**
 * 
 * @authors Your Name (you@example.org)
 * @date    2016-12-03 15:10:40
 * @version $Id$
 */

var page = {
	_init:function(){
		var _ = this;
		_._nav();
		_._player();
		_._numanimate();
		var page = $('.content').attr('data-p');
		if(page =='index'){
			_._banner();
		}
		if(page =='share'){
			_._sharecur();
		}
		if(page == 'joinus'){
			_._joinus();
		}
		if(page == "download"){
			_._download();
		}
		if(page == "family"){
			_._family();
		}
	},
	_nav:function(){
		$('.nav-item li').hover(function() {
			$(this).find('span').removeClass('nav-out').addClass('nav-in');
		}, function() {
			$(this).find('span').addClass('nav-out').removeClass('nav-in');
		});
	},
	_banner:function(){
		var swiper = new Swiper('.swiper-container', {
	        pagination: '.swiper-pagination',
	        paginationClickable: true,
	        autoplay : 6000,
			speed:500,
	    });
	},
	_player:function(){

		var myVideo=document.getElementById("video");
		var e = document.getElementById("player");

		if(e){
				var o = 16 / 9;
		var  n = .8 * Math.min(document.documentElement.clientWidth, document.documentElement.clientHeight * o),
            r = n / o;
		e.style.width = n + "px";
        e.style.height = r + "px";
        myVideo.style.width = n + "px";
        myVideo.style.height = r + "px";
        e.style.top = (document.documentElement.clientHeight - r) / 2 + "px";
		$('#playbtn').on('click', function(event) {
			$('.player-warp').show();
			$('.player').css("opacity",1);
			
		});
		$('.player-close,.plbg').on('click', function(event) {
			$('.player-warp').fadeOut(600);
			myVideo.pause(); 
			event.preventDefault();
		});	
		}


		  
	},
	_numanimate:function() {
		var _ = this;
		var lock = 0;
		$(window).on('scroll', function(event) {
			var footertop = document.getElementsByTagName("footer")[0].getBoundingClientRect().top;
			if(lock === 0){
				if(footertop < document.documentElement.clientHeight){
					lock=1;
					$(".numberRun").numberAnimate({num:carnum, speed:2000});
				}
			}
		});
		$('#wechat').hover(function() {
			$('.wechat-qrcode').stop(false,true).fadeIn(600);
		}, function() {
			$('.wechat-qrcode').stop(false,true).fadeOut(600);
			/* Stuff to do when the mouse leaves the element */
		});
	},
	_sharecur:function(){
		var _ = this;
		var lock = 0;
		// $(window).on('scroll', function(event) {
		// 	var stop = document.getElementsByClassName("s-carcount")[0].getBoundingClientRect().top;
		// 	if(lock === 0){
		// 		if(stop < document.documentElement.clientHeight){
		// 			lock=1;
		// 			$(".numberRun1").numberAnimate({num:carnum, speed:2000});
		// 		}
		// 	}
		// });
	},
	_joinus:function(){
		var _ = this;
		var lock = 0;
		$(window).on('scroll', function(event) {
			var wtop = document.getElementsByClassName("post")[0].getBoundingClientRect().top;
			
			if(lock === 0){
				if(wtop < document.documentElement.clientHeight){
					lock=1;
					//$('.welfare li').addClass('fain');
										$(".post").addClass("in");
				}
			}
		});
		//$('.post li a').each(function(index, el) {
			$('.post li a').on('click', function(event) {
				var id = $(this).data('id');
				$.post("/home/join/detail",{id:id},function(result){
					//alert(result.title);
					$('#cptitle').html(result.title);
					$('#cpcontent').html(result.content);
					$('.post-warp').fadeIn(600);
				    $('.post-cp').show();
				  },'json');
				
			});	
	//	});
		$('#close').on('click',  function(event) {
			$('.post-warp').fadeOut(600);
			$('.post-w').fadeOut(600);
		});

		 
		$(".post-w").mCustomScrollbar({
	        autoHideScrollbar:true,
	        theme:"minimal-dark",
	        mouseWheel:{
               
                preventDefault:true
               
            },
	    });
	},
	_download:function(){
		var _ = this;
		var lock = 0;
		$(window).on('scroll', function(event) {
			var wtop = document.getElementsByClassName("steps-warp")[0].getBoundingClientRect().top;
			if(lock === 0){
				if(wtop < document.documentElement.clientHeight){
					lock=1;
					$('.steps-warp li').addClass('fain');
				}
			}
		});
	},
	_family:function(){
		$('.pic-show').imagesLoaded(function() {
			$('.grid').masonry({
				itemSelector: '.grid-item',
				percentPosition: true
			});
			$('.grid-item').on('mouseover', function(event) {
				$(this).find('.mask').stop(false,true).fadeIn(300);
				/* Act on the event */
			}).on('mouseout', function(event) {
				$(this).find('.mask').stop(false,true).fadeOut(300);
			});
		});
	},
};
$(function(){
	// videojs.options.flash.swf = "video-js.swf";
	page._init();
});